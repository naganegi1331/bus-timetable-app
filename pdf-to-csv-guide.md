# PDFからCSVへの変換ガイド

このガイドでは、PDF形式のバス時刻表データをCSV形式に変換し、アプリで使用できるようにする方法を説明します。

## 1. PDFからデータを抽出する方法

### オンラインツールを使用する方法

1. **Tabula**（https://tabula.technology/）
   - 無料のオープンソースツール
   - PDFをアップロードし、表形式のデータを抽出
   - CSVとしてエクスポート可能

2. **PDF Tables Online**（https://pdftables.com/）
   - 一部無料、大量の変換は有料
   - PDFをアップロードしてCSVに変換

3. **Adobe Acrobat Pro**
   - 有料ソフトウェア
   - 「ツール」→「表を抽出」機能を使用

### 手動で抽出する方法

1. PDFを開いて時刻表データを確認
2. スプレッドシート（Excel、Google スプレッドシートなど）を開く
3. データを手動でコピー＆ペーストまたは入力
4. CSVとして保存

## 2. CSVデータの形式

バス時刻表アプリで使用するCSVデータは、以下のいずれかの形式に整形する必要があります：

### シンプル形式（路線ごとに1ファイル）

```
day_type,departure_times
weekday,06:30,07:00,07:30,08:00,08:30,09:00
saturday,07:00,07:30,08:00,08:30,09:00,09:30
sunday,08:00,08:30,09:00,09:30,10:00,10:30
```

### 複合形式（複数路線を1ファイルに）

```
route_id,route_name,route_description,day_type,departure_times
1,駅前 → 市役所,中央駅から市役所経由,weekday,06:30,07:00,07:30,08:00
1,駅前 → 市役所,中央駅から市役所経由,saturday,07:00,07:30,08:00,08:30
1,駅前 → 市役所,中央駅から市役所経由,sunday,08:00,08:30,09:00,09:30
2,駅前 → 大学,中央駅から大学経由,weekday,07:15,07:45,08:15,08:45
```

## 3. PDFからCSVへの変換例

### 例：典型的なバス時刻表PDFの場合

多くのバス時刻表PDFは以下のような形式になっています：

```
路線名：駅前 → 市役所

平日
 6時：30
 7時：00 30
 8時：00 30
...

土曜
 7時：00 30
...

日曜・祝日
 8時：00 30
...
```

### 変換手順

1. 各時間帯の発車時刻を抽出
2. 時刻を「HH:MM」形式に変換（例：「6時：30」→「06:30」）
3. 曜日タイプごとに分類（weekday, saturday, sunday）
4. CSVフォーマットに整形

### スプレッドシートを使った変換例

1. スプレッドシートを開く
2. A列に曜日タイプ（weekday, saturday, sunday）を入力
3. B列以降に発車時刻を入力
4. CSVとして保存（「名前を付けて保存」→「CSV」）

## 4. CSV変換ツールの使用方法

1. `csv-converter.html` をブラウザで開く
2. CSVフォーマットを選択（シンプル形式または複合形式）
3. シンプル形式の場合は、路線情報（ID、名前、説明）を入力
4. CSVデータを貼り付け
5. 「変換」ボタンをクリック
6. 生成されたJavaScriptコードを `data.js` にコピー

## 5. よくある問題と解決方法

### 時刻形式の問題

- **問題**: PDFから抽出した時刻が「6:30」のように0埋めされていない
- **解決**: スプレッドシートでセルの書式を「00:00」形式に設定

### 複数路線の処理

- **問題**: 複数の路線がある場合の処理が複雑
- **解決**: 複合形式のCSVを使用するか、路線ごとに個別のCSVファイルを作成して順次変換

### 特殊な運行パターン

- **問題**: 平日・土曜・日曜以外の特殊な運行パターン（祝日ダイヤなど）
- **解決**: アプリのコードを拡張するか、最も近い運行パターン（通常は日曜）に含める
